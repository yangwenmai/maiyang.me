---
date: 2014-08-02 00:00:00 +0800
title: 小型局域网的多路由配置
description: 本文将讨论我在实际生活中遇到的问题——小型局域网多路由的配置。今天刚回到家，我妈就找到我说公司里的几台无线路由用不了，在同一时刻只能用一个路由，其他的都得拔掉。我第一反应就是ip冲突了，但是感觉很麻烦的样子，因为要合理管理公司里的网络，肯定需要一个网管来分配网段嘛。可是老妈说急用啊，这次一定要搞好！没办法，硬着头皮上吧！
permalink: /posts/networkConfig/
key: 10010
labels: [网络, 路由器]
---

今天刚回到家，我妈就找到我说公司里的几台无线路由用不了，在同一时刻只能用一个路由，其他的都得拔掉。我第一反应就是 IP 冲突了，但是感觉很麻烦的样子，因为要合理管理公司里的网络，肯定需要一个网管来分配网段嘛。可是老妈说急用啊，这次一定要搞好！没办法，硬着头皮上吧！

## 问题
使得6个无线路由可以同时正常工作。

## 情景
从 Modem 出来的网线接到交换机 A 上，从交换机中接到2个路由器，并同时接上交换机 B；从交换机 B 中再接到4个路由器上。下面是图示：

![network config][1]

## 解决
其实在这个场景中，6个路由器是平级的，并不需要设置二级路由，所以设置非常简单。

- WAN口设置：
  - IP: `192.168.1.x (x!=1 && x >= 0 && x <= 255)`：6个路由器的`x`不可重复，每个路由器对下都有一个各自的子网，对上需要有唯一的地址来收发数据，即 IP 地址。`x!=1`是为了防止和 Modem 的 IP 地址冲突。
  - 子网掩码: `255.255.255.0`
  - 网关: `192.168.1.1` ：Modem 一般都是`192.168.1.1`，如果不是请修改成 Modem 的地址。
- LAN口设置：
  - IP: `192.168.y.1 (y!=1 && y >= 0 && y <= 255)` ：LAN 口是路由器对下的接口，Client 可以通过 LAN 口的 IP 地址来访问路由器。
  - 子网掩码: `255.255.255.0`

**我觉得比较好的实践是使得 x === y。** 

## 总结
第一次认真地思考了一下这个问题，肯定有理解不到位的地方，欢迎拍砖。另外了解了子网掩码、Modem 和路由的一些常识后，感觉很有趣。可惜当初的计算机网络课没有好好上，有点后悔啊。

[1]: {{ site.static_url }}/posts/network_config.png
